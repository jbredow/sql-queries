SELECT CCOR.BRANCH_NUMBER_NK BU_NUM,
  CUST.SALESMAN_CODE,
  CUST.CUSTOMER_NAME,
  CCOR.CUSTOMER_NK,
  CUST.JOB_YN,
  CCOR.CONTRACT_ID,
  CONTRACT.CONTRACT_NAME,
  CCOR.DISC_GROUP DG,
  DG.DISCOUNT_GROUP_NAME,  
  PROD.PRODUCT_NK,
  PROD.ALT1_CODE,
  CCOR.OVERRIDE_ID_NK,
  CCOR.EFFECTIVE_PROD COST_CCOR,
  CCOR.BASIS SELL_BASIS,
  CCOR.OPERATOR_USED SELL_OPER,
  CCOR.MULTIPLIER SELL_MULT,
  CCOR.EXPIRE_DATE,
  CONTACTS.RPC

FROM DW_FEI.CUSTOMER_OVERRIDE_DIMENSION CCOR
  INNER JOIN DW_FEI.CUSTOMER_DIMENSION CUST
    ON (CCOR.CUSTOMER_GK = CUST.CUSTOMER_GK)
  LEFT JOIN DW_FEI.CUSTOMER_CONTRACT_DIMENSION CONTRACT
    ON (CONTRACT.CONTRACT_ID = CCOR.CONTRACT_ID 
        AND CONTRACT.BRANCH_NUMBER_NK = CCOR.BRANCH_NUMBER_NK
        AND CONTRACT.CUSTOMER_NK = CCOR.CUSTOMER_NK)
  LEFT JOIN DW_FEI.DISCOUNT_GROUP_DIMENSION DG
    ON (DG.DISCOUNT_GROUP_NK = CCOR.DISC_GROUP)
  LEFT JOIN DW_FEI.PRODUCT_DIMENSION PROD
    ON (PROD.PRODUCT_NK = CCOR.MASTER_PRODUCT)
  LEFT JOIN AAF1046.BRANCH_CONTACTS CONTACTS
    ON (CONTACTS.ACCOUNT_NK = CCOR.BRANCH_NUMBER_NK)
    
WHERE CCOR.DELETE_DATE IS NULL
  AND CUST.DELETE_DATE IS NULL
  AND CCOR.EFFECTIVE_PROD IS NOT NULL
  --AND CCOR.CUSTOMER_NK = '326163'
  
  --Choose Branch?
  AND CCOR.BRANCH_NUMBER_NK = '1300';
    
  --Exclude DC Contracts?
  --AND CONTRACT.CONTRACT_NAME NOT LIKE '%/%/%';