
SELECT DISTINCT CONTACTS.RPC,
	CONTACTS.DISTRICT,
	CCORG.BRANCH_NUMBER_NK,
    CONTACTS.ALIAS,
    CCORG.CUSTOMER_NK,
    CCORG.CONTRACT_ID,
    CCORG.OVERRIDE_ID_NK,
    CCORG.OVERRIDE_TYPE,
    CCORG.DISC_GROUP,
    DG.DISCOUNT_GROUP_NAME,
    NULL AS ALT1_CODE,
    NULL AS PRODUCT_NAME,
    CCORG.EXPIRE_DATE,
    CCORG.BASIS,
    CCORG.OPERATOR_USED,
    CCORG.MULTIPLIER,
    CCORG.INSERT_TIMESTAMP,
    CCORG.UPDATE_TIMESTAMP,
    CCORG.LAST_UPDATE,
    CCORG.DELETE_DATE

FROM DW_FEI.CUSTOMER_OVERRIDE_DIMENSION CCORG,
     DW_FEI.DISCOUNT_GROUP_DIMENSION DG,
     AAA6863.BRANCH_CONTACTS CONTACTS,
     AAA6863.HIPP_DG_LIST HIPP
     
WHERE CCORG.DISC_GROUP = DG.DISCOUNT_GROUP_NK
    AND CONTACTS.ACCOUNT_NK = CCORG.BRANCH_NUMBER_NK
    AND CCORG.OVERRIDE_TYPE = 'G'
    AND HIPP.DG_TEXT = CCORG.DISC_GROUP
    AND CCORG.DELETE_DATE IS NULL
    AND CONTACTS.RPC = 'Midwest'
	AND CCORG.EXPIRE_DATE IS NULL
    
UNION

SELECT DISTINCT CONTACTS.RPC,
	CONTACTS.DISTRICT,
	CCORP.BRANCH_NUMBER_NK,
    CONTACTS.ALIAS,
    CCORP.CUSTOMER_NK,
    CCORP.CONTRACT_ID,
    CCORP.OVERRIDE_ID_NK,
    CCORP.OVERRIDE_TYPE,
    PROD.DISCOUNT_GROUP_NK,
    DG.DISCOUNT_GROUP_NAME,
    PROD.ALT1_CODE,
    PROD.PRODUCT_NAME,
    CCORP.EXPIRE_DATE,
    CCORP.BASIS,
    CCORP.OPERATOR_USED,
    CCORP.MULTIPLIER,
    CCORP.INSERT_TIMESTAMP,
    CCORP.UPDATE_TIMESTAMP,
    CCORP.LAST_UPDATE,
    CCORP.DELETE_DATE
    
FROM DW_FEI.CUSTOMER_OVERRIDE_DIMENSION CCORP,
     DW_FEI.PRODUCT_DIMENSION PROD,
     DW_FEI.DISCOUNT_GROUP_DIMENSION DG,
     AAA6863.BRANCH_CONTACTS CONTACTS,
     AAA6863.HIPP_DG_LIST HIPP
     
WHERE CCORP.MASTER_PRODUCT = PROD.PRODUCT_NK
    AND PROD.DISCOUNT_GROUP_NK = DG.DISCOUNT_GROUP_NK
    AND CONTACTS.ACCOUNT_NK = CCORP.BRANCH_NUMBER_NK
    AND CCORP.OVERRIDE_TYPE = 'P'
    AND HIPP.DG_TEXT = PROD.DISCOUNT_GROUP_NK
    AND CCORP.DELETE_DATE IS NULL
    AND CONTACTS.RPC = 'Midwest'
	AND CORP.EXPIRE_DATE IS NULL
    ;