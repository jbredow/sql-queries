
SELECT DISTINCT
       SWD.DIVISION_NAME AS REGION,
       SWD.REGION_NAME AS DISTRICT,
       PM_DET.PRICE_CATEGORY,
       PM_DET.YEARMONTH,
       SUM (PM_DET.EXT_SALES_AMOUNT) EX_SALES,
       SUM (PM_DET.EXT_AVG_COGS_AMOUNT) EX_AC,
			 SUM (
				CASE
					WHEN PM_DET.PRICE_CATEGORY IN 'SPECIAL'
					THEN 
						( PM_DET.EXT_SALES_AMOUNT )
					ELSE
						0
				END )
					"SP- SALES",
				SUM (
					CASE
					WHEN PM_DET.PRICE_CATEGORY IN 'SPECIAL'
					THEN 
						( PM_DET.EXT_AVG_COGS_AMOUNT )
					ELSE
						0
				END )
					"SP- AC"
					
  FROM    (   SALES_MART.PRICE_MGMT_DATA_DET PM_DET
           INNER JOIN
              SALES_MART.SALES_WAREHOUSE_DIM SWD
           ON (PM_DET.SELL_WAREHOUSE_NUMBER_NK = SWD.WAREHOUSE_NUMBER_NK))
       INNER JOIN
          SALES_MART.TIME_PERIOD_DIMENSION TPD
       ON (PM_DET.YEARMONTH = TPD.YEARMONTH)
 WHERE     (PM_DET.IC_FLAG = 'REGULAR')
       AND (SWD.DIVISION_NAME = 'NORTH CENTRAL REGION')
       AND (TPD.ROLL12MONTHS IS NOT NULL)
GROUP BY SWD.DIVISION_NAME,
         SWD.REGION_NAME,
         PM_DET.IC_FLAG,
         TPD.ROLL12MONTHS,
         PM_DET.PRICE_CATEGORY,
         PM_DET.YEARMONTH;