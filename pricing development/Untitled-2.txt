
SELECT SWD.DIVISION_NAME AS REGION,
       SWD.REGION_NAME AS DISTRICT,
       SWD.ACCOUNT_NUMBER_NK AS BRANCH_NK,
       SWD.ACCOUNT_NAME AS ALIAS,
       CUST.CUSTOMER_NK,
       CUST.CUSTOMER_NAME,
       CUST.MAIN_CUSTOMER_NK,
       BR_POA_HDR.DRAWER,
       BR_POA_HDR.APPLY_TO,
       BR_POA_HDR.ENTRY_DATE,
       BR_POA_HDR.COMMENTS,
       BR_POA_line.PAID_BY,
       BR_POA_line.AMOUNT_PAID,
       BR_POA_line.INSERT_TIMESTAMP,
       BR_POA_line.UPDATE_TIMESTAMP,
       CUST.TERMS,
       CUST.CREDIT_CODE,
       CUST.CREDIT_LIMIT,
       BR_POA_line.PAY_KEY_NK,
       BR_POA_line.LINE_NUMBER_NK,
       PRICE_MGMT_DATA_DET.IC_FLAG,
       SUM (PRICE_MGMT_DATA_DET.EXT_SALES_AMOUNT),
       SUM (PRICE_MGMT_DATA_DET.EXT_AVG_COGS_AMOUNT)
  FROM    (   (   (   (   DW_FEI.BR_PAY_ON_ACCT_HEADER_FACT BR_POA_HDR
                       INNER JOIN
                          DW_FEI.BR_PAY_ON_ACCT_LINE_FACT BR_POA_line
                       ON (BR_POA_HDR.ACCOUNT_NUMBER_NK =
                              BR_POA_line.ACCOUNT_NUMBER_NK)
                          AND (BR_POA_HDR.PAY_KEY_NK = BR_POA_line.PAY_KEY_NK)
                          AND (BR_POA_HDR.CUSTOMER_GK =
                                  BR_POA_line.CUSTOMER_GK))
                   INNER JOIN
                      SALES_MART.SALES_WAREHOUSE_DIM SWD
                   ON (SWD.WAREHOUSE_NUMBER_NK =
                          BR_POA_HDR.WAREHOUSE_NUMBER_NK))
               INNER JOIN
                  DW_FEI.CUSTOMER_DIMENSION CUST
               ON (CUST.CUSTOMER_GK = BR_POA_HDR.CUSTOMER_GK))
           LEFT OUTER JOIN
              SALES_MART.PRICE_MGMT_DATA_DET PRICE_MGMT_DATA_DET
           ON (PRICE_MGMT_DATA_DET.CUSTOMER_GK = CUST.CUSTOMER_GK)
              AND (PRICE_MGMT_DATA_DET.ACCOUNT_NUMBER_NK =
                      CUST.ACCOUNT_NUMBER_NK))
       INNER JOIN
          SALES_MART.TIME_PERIOD_DIMENSION TIME_PERIOD_DIMENSION
       ON (TIME_PERIOD_DIMENSION.YEARMONTH = PRICE_MGMT_DATA_DET.YEARMONTH)
 WHERE ( BR_POA_LINE.INSERT_TIMESTAMP 
											BETWEEN TRUNC ( SYSDATE - 6 ) AND	TRUNC ( SYSDATE - 1)
			 )
       AND (SWD.ACCOUNT_NUMBER_NK = '2000')
       AND (CUST.MAIN_CUSTOMER_NK = 'REGULAR')
GROUP BY SWD.DIVISION_NAME,
         SWD.REGION_NAME,
         SWD.ACCOUNT_NUMBER_NK,
         SWD.ACCOUNT_NAME,
         CUST.CUSTOMER_NK,
         CUST.CUSTOMER_NAME,
         CUST.MAIN_CUSTOMER_NK,
         BR_POA_HDR.DRAWER,
         BR_POA_HDR.APPLY_TO,
         BR_POA_HDR.ENTRY_DATE,
         BR_POA_HDR.COMMENTS,
         BR_POA_line.PAID_BY,
         BR_POA_line.AMOUNT_PAID,
         BR_POA_line.INSERT_TIMESTAMP,
         BR_POA_line.UPDATE_TIMESTAMP,
         CUST.TERMS,
         CUST.CREDIT_CODE,
         CUST.CREDIT_LIMIT,
         BR_POA_line.PAY_KEY_NK,
         BR_POA_line.LINE_NUMBER_NK,
         PRICE_MGMT_DATA_DET.IC_FLAG

;