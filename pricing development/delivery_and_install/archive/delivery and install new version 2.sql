-- Please press Visualize Query context menu item to synchronize query and diagram after editing. 

SELECT SWD.DIVISION_NAME REGION,
       SWD.REGION_NAME DISTRICT,
       SWD.REGION_NAME DIST,
       SWD.ACCOUNT_NUMBER_NK,
       SWD.ACCOUNT_NAME,
       SWD.WAREHOUSE_NUM_NAME,
       IHF.WRITER,
       IHF.WRITER WRITER2,       
       PROD.DISCOUNT_GROUP_NK,
       PROD.ALT1_CODE,
       PROD.PRODUCT_NK,
       PROD.PRODUCT_NAME,
       P_CAT.PRICE_CATEGORY_FINAL,
       SUM (P_CAT.SHIPPED_QTY) AS SHIPPED,
       SUM (P_CAT.EXT_SALES_AMOUNT) AS EXT_SALES,
       SUM (P_CAT.EXT_ACTUAL_COGS_AMOUNT) AS EXT_REP_COGS
       SUM (P_CAT.
FROM ((((DW_FEI.INVOICE_LINE_FACT INVOICE_LINE_FACT
         INNER JOIN DW_FEI.PRODUCT_DIMENSION PROD
            ON (INVOICE_LINE_FACT.PRODUCT_GK = PROD.PRODUCT_GK))
        INNER JOIN PRICE_MGMT.PR_PRICE_CAT_HIST P_CAT
           ON     (P_CAT.INVOICE_NUMBER_GK =
                   INVOICE_LINE_FACT.INVOICE_NUMBER_GK)
              AND (P_CAT.PRODUCT_GK = INVOICE_LINE_FACT.PRODUCT_GK))
       INNER JOIN SALES_MART.SALES_WAREHOUSE_DIM SWD
          ON (P_CAT.WAREHOUSE_NUMBER = SWD.WAREHOUSE_NUMBER_NK))
      INNER JOIN SALES_MART.TIME_PERIOD_DIMENSION TPD
         ON (P_CAT.YEARMONTH = TPD.YEARMONTH))
     INNER JOIN DW_FEI.INVOICE_HEADER_FACT IHF
        ON     (INVOICE_LINE_FACT.INVOICE_NUMBER_GK = IHF.INVOICE_NUMBER_GK)
           AND (INVOICE_LINE_FACT.YEARMONTH = IHF.YEARMONTH)
WHERE     (PROD.DISCOUNT_GROUP_NK = '9181')
      AND (TPD.FISCAL_YEAR_TO_DATE = 'YEAR TO DATE')
GROUP BY SWD.DIVISION_NAME,
         SWD.REGION_NAME,
         SWD.ACCOUNT_NUMBER_NK,
         SWD.ACCOUNT_NAME,
         SWD.WAREHOUSE_NUM_NAME,
         PROD.DISCOUNT_GROUP_NK,
         PROD.ALT1_CODE,
         PROD.PRODUCT_NK,
         PROD.PRODUCT_NAME,
         P_CAT.PRICE_CATEGORY_FINAL,
         IHF.WRITER,
         TPD.FISCAL_YEAR_TO_DATE