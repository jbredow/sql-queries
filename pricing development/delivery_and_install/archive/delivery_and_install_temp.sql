SELECT DISTINCT TPD.YEARMONTH,
                SWD.DIVISION_NAME,
                SWD.REGION_NAME,
                SWD.ACCOUNT_NAME,
                SWD.ACCOUNT_NUMBER_NK,
                SWD.WAREHOUSE_NUM_NAME,
                IHF.WRITER,
                ILF.ALT_CODE,
                ILF.PRODUCT_NUMBER_NK,
                SUM (ILF.EXT_SALES_AMOUNT) AS EXT_SALES,
                SUM (ILF.EXT_AVG_COGS_AMOUNT) AS EXT_AVG_COGS,
                SUM (ILF.EXT_ACTUAL_COGS_AMOUNT) AS EXT_INV_COGS
  FROM ((DW_FEI.INVOICE_HEADER_FACT IHF
         INNER JOIN SALES_MART.TIME_PERIOD_DIMENSION TPD
            ON (IHF.YEARMONTH = TPD.YEARMONTH))
        INNER JOIN DW_FEI.INVOICE_LINE_FACT ILF
           ON (ILF.INVOICE_NUMBER_GK = IHF.INVOICE_NUMBER_GK))
       INNER JOIN SALES_MART.SALES_WAREHOUSE_DIM SWD
          ON (IHF.WAREHOUSE_NUMBER = SWD.WAREHOUSE_NUMBER_NK)
 WHERE (SWD.ACCOUNT_NUMBER_NK = '2000') 
    AND (ILF.DISCOUNT_GROUP_NK = '9181')
    AND (TPD.FISCAL_YEAR_TO_DATE = 'YEAR TO DATE')
GROUP BY TPD.YEARMONTH,
         TPD.FISCAL_YEAR_TO_DATE,
         SWD.DIVISION_NAME,
         SWD.REGION_NAME,
         SWD.ACCOUNT_NAME,
         SWD.ACCOUNT_NUMBER_NK,
         SWD.WAREHOUSE_NUM_NAME,
         IHF.WRITER,
         ILF.ALT_CODE,
         ILF.PRODUCT_NUMBER_NK,
         ILF.DISCOUNT_GROUP_NK
  ;